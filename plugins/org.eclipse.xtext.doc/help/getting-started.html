<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Getting Started</title>
<link href="book.css" rel="stylesheet" type="text/css">
<meta content="DocBook XSL Stylesheets V1.75.1" name="generator">
<link rel="home" href="index.html" title="Xtext User Guide">
<link rel="up" href="index.html" title="Xtext User Guide">
<link rel="prev" href="DSL.html" title="What is a domain-specific language">
<link rel="next" href="getting-started-xpand.html" title="Writing a code generator">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<h1 xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0">Getting Started</h1>
<p>In this mini-tutorial you will implement your first language with Xtext and create an editor from that. Later, we will create a code generator that is capable of reading the models you create with the DSL editor and process them.</p>
<div class="section" title="Creating a DSL">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both">
<a name="getting-started-xtext"></a>Creating a DSL  </h2>
</div>
</div>
</div>
<p>
				
<a class="ulink" href="http://www.eclipse.org/Xtext/download/" target="_new">Download and install the latest version of Xtext</a>, set up a fresh workspace, take a deep breath and follow the instructions.  As soon as you have finished this chapter you will have an editor that understands input files of the following format. We will refer to this snippet as an example of our &bdquo;target syntax&rdquo; later on:
			</p>
<div class="literallayout">
<p>
<code class="code">type&nbsp;String<br>
type&nbsp;Bool<br>

<br>
entity&nbsp;Session&nbsp;{<br>
&nbsp;&nbsp;property&nbsp;Title:&nbsp;String<br>
&nbsp;&nbsp;property&nbsp;IsTutorial&nbsp;:&nbsp;Bool<br>
}<br>

<br>
entity&nbsp;Conference&nbsp;{<br>
&nbsp;&nbsp;property&nbsp;Name&nbsp;:&nbsp;String<br>
&nbsp;&nbsp;property&nbsp;Attendees&nbsp;:&nbsp;Person[]<br>
&nbsp;&nbsp;property&nbsp;Speakers&nbsp;:&nbsp;Speaker[]<br>
}<br>

<br>
entity&nbsp;Person&nbsp;{<br>
&nbsp;&nbsp;property&nbsp;Name&nbsp;:&nbsp;String<br>
}<br>

<br>
entity&nbsp;Speaker&nbsp;extends&nbsp;Person&nbsp;{<br>
&nbsp;&nbsp;property&nbsp;Sessions&nbsp;:&nbsp;Session[]<br>
}<br>

<br>

</code>
</p>
</div>
<div class="section" title="Create an Xtext project">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="CreateanXtextproject"></a>Create an Xtext project</h3>
</div>
</div>
</div>
<p>Use the Xtext wizard to create a new project</p>
<p>	
					
<span class="emphasis"><em>File -&gt; New -&gt; Project...  -&gt; Xtext -&gt; Xtext project</em></span>
				
</p>
<p>Choose a meaningful project name, language name and file extension, e.g.</p>
<table id="N1008A">
<tr>
						
<td>
							<span class="bold"><strong>Main project name:</strong></span> 	
						</td>
						<td>org.xtext.example.start	</td>
					
</tr>
<tr>
						
<td>
							<span class="bold"><strong>Language name:</strong></span> 		
						</td>
						<td>org.xtext.example.Entities	</td>
					
</tr>
<tr>
						
<td>
							<span class="bold"><strong>DSL-File extension:</strong></span> 	
						</td>
						<td>entity	</td>
					
</tr>
</table>
<p>Keep &bdquo;Create generator project&rdquo; checked, as we will also create a code generator in a second step.</p>
<p>Click on 
					<span class="emphasis"><em>Finish</em></span> to create the projects. 
				</p>
<p>
					
</p>
<div class="mediaobject">
<img src="images/getting-started-wizard.png"></div>
<p>
				
</p>
</div>
<div class="section" title="Project layout">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="Projectlayout"></a>Project layout</h3>
</div>
</div>
</div>
<p>In the Package Explorer you can see three new projects. In 
					<code class="code">org.xtext.example.start</code> you can define the grammar and configure the runtime aspects of your language. The editor, outline view and code completion goes into 
					<code class="code">org.xtext.example.start.ui</code>. Both projects consist of generated classes derived from your grammar and manual code such as the grammar itself or further classes to differentiate from the default behavior.
				</p>
<p>
					
</p>
<div class="mediaobject">
<img src="images/getting-started-project-layout.png"></div>
<p>
				
</p>
<p>It is good to be clear and unambiguous whether the code is generated or is to be manipulated by the developer. Thus, the generated code should be held separately from the manual code. We follow this pattern by having a folder src/ and a folder src-gen/ in each project. Keep in mind not to make changes in the src-gen/ folder. They will be overwritten by the generator.</p>
<p>A third project, 
					<code class="code">org.xtext.example.start.generator</code> will later contain a code generator that leverages the model created with the DSL editor.
				</p>
</div>
<div class="section" title="Build your own grammar">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="Buildyourowngrammar"></a>Build your own grammar</h3>
</div>
</div>
</div>
<p>The wizard will automatically open the example grammar file 
					<code class="code">Entities.xtext</code> from the first project in the editor. A grammar has two purposes. First, it is used to describe the concrete syntax of your language. Second, it contains information about how a parser shall create a model during parsing.
				</p>
<p>Ignore the generated sample grammar, delete everything after "
					<code class="code">Model :</code>" to the end. 
					The entry rule for the parser will be called 
					<code class="code">Model</code>. As a 
					<code class="code">Model</code> consists of one or more 
					<code class="code">Entity</code> entries, this rule delegates to another rule named 
					<code class="code">Entity</code>, which will be defined later on.
					As we can have one ore more entities within a model, the cardinality is &bdquo;+&rdquo;. Each rule is terminated with a semicolon. So our first rule reads as
				</p>
<div class="literallayout">
<p>
<code class="code">Model&nbsp;:<br>
&nbsp;&nbsp;Entity+;&nbsp;<br>

<br>

</code>
</p>
</div>
<p>
					
<span class="italic">
						<span class="bold"><strong>Please note</strong></span>: If you encounter strange errors while copying and pasting these snippets to your Eclipse editor your documentation viewer most likely has inserted characters different from {space} into your clipboard. Reenter these &bdquo;fillers&rdquo; or type the text by hand to be sure everything works fine.
					</span> 
				
</p>
<p>An Xtext grammar does not only describe rules for the parser but also the structure of the resulting abstract syntax tree. Usually, each parser rule will create a new node in that tree. The type of that node can be specified after the rule name using the keyword 
					<code class="code">returns</code>. If the type&rsquo;s name is the same as the rule name, it can be omitted as in our case.
				</p>
<p>The parser will create a new element of type 
					<code class="code">Model</code> when it enters the rule 
					<code class="code">Model</code>, and a new element of type 
					<code class="code">Entity</code> every time it enters the rule 
					<code class="code">Entity</code>. To connect these AST elements, we have to define the name of a reference. In our case, we call that reference 
					<span class="emphasis"><em>entities</em></span>. We specify it using the assignment operator "
					<code class="code">+=</code>", which denotes a multi valued feature. 
				</p>
<p>As a result, we modify the first rule to</p>
<div class="literallayout">
<p>
<code class="code">Model&nbsp;:<br>
&nbsp;&nbsp;(elements&nbsp;+=&nbsp;Entity)+;<br>
	
<br>

</code>
</p>
</div>
<p>The next rule on our list is the rule 
					<code class="code">Entity</code>. Looking at our target syntax, each entity begins with the keyword 
					<code class="code">entity</code> followed by the entity&rsquo;s name and an opening curly brace (we will handle the 
					<code class="code">extends</code> clause in a second step). Then, an entity defines a number of properties and ends with a closing curly brace. 
				</p>
<div class="literallayout">
<p>
<code class="code">Entity&nbsp;returns&nbsp;Entity:<br>
&nbsp;&nbsp;'entity'&nbsp;name=ID&nbsp;'{'<br>
&nbsp;&nbsp;&nbsp;&nbsp;(properties+=Property)*<br>
&nbsp;&nbsp;'}'<br>
;<br>
	
<br>

</code>
</p>
</div>
<p>Instead of creating a new AST node for the name, we rather want the name to be an attribute of the 
					<code class="code">Entity</code> class. Therefore we use the terminal rule 
					<code class="code">ID</code>, which results in a string. The assignment operator "
					<code class="code">=</code>" denotes a single valued feature, and the asterisk a cardinality of 0..n.
					In our target syntax, some entities refer to an existing entity as their super type after the keyword 
					<code class="code">extends</code>. Note that this is a cross-reference, as the super type itself must be defined somewhere else. To define a cross-reference we use square brackets. Optional parts have the cardinality &bdquo;?&rdquo;. The complete rule now reads:
				</p>
<div class="literallayout">
<p>
<code class="code">Entity&nbsp;returns&nbsp;Entity:<br>
&nbsp;&nbsp;'entity'&nbsp;name=ID&nbsp;('extends'&nbsp;extends=[Entity])?&nbsp;'{'<br>
&nbsp;&nbsp;&nbsp;&nbsp;(properties+=Property)*<br>
&nbsp;&nbsp;'}'<br>
;<br>
	
<br>

</code>
</p>
</div>
<p>We have not specified the rule 
					<code class="code">Property</code>, yet. In our target syntax, properties can refer to simple types such as &bdquo;String&rdquo; or &bdquo;Bool&rdquo; as well as entities. To make this easy we will first introduce a common supertype 
					<code class="code">Type</code> each 
					<code class="code">Property</code> can refer to.
				</p>
<p>Change  the rule 
					<code class="code">Model</code> and introduce a new rule 
					<code class="code">Type</code> and 
					<code class="code">SimpleType</code>:
				</p>
<div class="literallayout">
<p>
<code class="code">Model&nbsp;:<br>
&nbsp;&nbsp;(elements+=Type)*;<br>

<br>
Type:<br>
&nbsp;&nbsp;SimpleType&nbsp;|&nbsp;Entity;<br>
	
<br>
SimpleType:<br>
&nbsp;&nbsp;'type'&nbsp;name=ID;<br>
&nbsp;<br>

</code>
</p>
</div>
<p>Models new consist of types where a 
					<code class="code">Type</code> can either be a 
					<code class="code">SimpleType</code>  or the 
					<code class="code">Entity</code> you already know. Our rule 
					<code class="code">Type</code> will just delegate to either of them, using the "
					<code class="code">|</code>" alternatives operator. The combination of simple data types and entites this way introduces a common super type 
					<code class="code">Type</code> both 
					<code class="code">Entity</code> and 
					<code class="code">SimpleType</code> derive from. This allows you to refer to both types of elements with a single cross-reference.
				</p>
<p>A 
					<code class="code">Property</code> consist of a keyword, a name, a colon and a cross-reference to an arbitrary 
					<code class="code">Type</code>. The multiplicity is either many or one. The presence of the postfix &bdquo;[]&rdquo; (technically a keyword) should trigger a boolean flag in the AST model. This is the purpose of the assignment operator "
					<code class="code">?=</code>". Our last parser rule is:
				</p>
<div class="literallayout">
<p>
<code class="code">Property:<br>
&nbsp;&nbsp;'property'&nbsp;name=ID&nbsp;':'&nbsp;type=[Type]&nbsp;(many?='[]')?;<br>
	
<br>

</code>
</p>
</div>
<p>In the end your grammar editor should look like this:</p>
<p>
					
</p>
<div class="mediaobject">
<img src="images/getting-started-grammar.png"></div>
<p>
				
</p>
</div>
<div class="section" title="Generate language artifacts">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="Generatelanguageartifacts"></a>Generate language artifacts</h3>
</div>
</div>
</div>
<p>Save the grammar and make sure that no error markers appear. Then, locate the file GenerateEntities.mwe next to the grammar file in the package explorer view. From its context menu, choose</p>
<p>	
					
<span class="emphasis"><em>Run As -&gt; MWE Workflow</em></span>.
				</p>
<p>That will trigger the Xtext language generator. You will see its logging messages in the Console view.</p>
</div>
<div class="section" title="Run the generated editor">
<div class="titlepage">
<div>
<div>
<h3 class="title">
<a name="Runthegeneratededitor"></a>Run the generated editor</h3>
</div>
</div>
</div>
<p>If code generation succeeded, right-click on the Xtext project and choose</p>
<p>	
					
<span class="emphasis"><em>Run As -&gt; Eclipse Application</em></span>.
				</p>
<p>This will spawn a new Eclipse workbench with your projects as plug-ins installed. 
					In the new workbench, create a new project (
					<span class="emphasis"><em>File -&gt; New -&gt; Project...  -&gt; General -&gt; Project</em></span>) and therein a new file with the file extension you chose in the beginning. This will open the generated entity editor.
				</p>
<p>To get some hands-on experience with your new DSL editor, type in the following model:</p>
<p>
					
</p>
<div class="mediaobject">
<img src="images/getting-started-editor.png"></div>
<p>
				
</p>
</div>
</div>
</body>
</html>
